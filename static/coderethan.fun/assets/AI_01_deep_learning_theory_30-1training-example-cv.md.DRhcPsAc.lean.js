import{_ as i,c as a,o as h,a2 as n}from"./chunks/framework.DA-Pb-tg.js";const g=JSON.parse('{"title":"1 ImageNet training in PyTorch","description":"","frontmatter":{},"headers":[],"relativePath":"AI/01_deep_learning_theory/30-1training-example-cv.md","filePath":"AI/01_deep_learning_theory/30-1training-example-cv.md","lastUpdated":1743069065000}'),t={name:"AI/01_deep_learning_theory/30-1training-example-cv.md"};function k(l,s,e,p,F,r){return h(),a("div",null,s[0]||(s[0]=[n(`<h1 id="_1-imagenet-training-in-pytorch" tabindex="-1">1 ImageNet training in PyTorch <a class="header-anchor" href="#_1-imagenet-training-in-pytorch" aria-label="Permalink to &quot;1 ImageNet training in PyTorch&quot;">​</a></h1><p>This implements training of popular model architectures, such as ResNet, AlexNet, and VGG on the ImageNet dataset.</p><h1 id="_2-requirements" tabindex="-1">2 Requirements <a class="header-anchor" href="#_2-requirements" aria-label="Permalink to &quot;2 Requirements&quot;">​</a></h1><ul><li>Install PyTorch (<a href="http://pytorch.org" target="_blank" rel="noreferrer">pytorch.org</a>)</li><li><code>pip install -r requirements.txt</code></li></ul><h1 id="_3-数据集下载" tabindex="-1">3 数据集下载： <a class="header-anchor" href="#_3-数据集下载" aria-label="Permalink to &quot;3 数据集下载：&quot;">​</a></h1><ul><li><p>Download the ImageNet dataset from <a href="http://www.image-net.org/" target="_blank" rel="noreferrer">http://www.image-net.org/</a></p><ul><li>Then, move and extract the training and validation images to labeled subfolders, using 地址: ./30-2extract_ILSVRC.sh</li></ul></li><li><p>imagenet 太大，我们用tiny-image-net 链接：<a href="https://pan.baidu.com/s/19uGnlOIsklJ9IbWbzFgldw?pwd=86sj" target="_blank" rel="noreferrer">https://pan.baidu.com/s/19uGnlOIsklJ9IbWbzFgldw?pwd=86sj</a> 提取码：86sj</p></li></ul><h1 id="_4-training" tabindex="-1">4 Training <a class="header-anchor" href="#_4-training" aria-label="Permalink to &quot;4 Training&quot;">​</a></h1><p>To train a model, run <code>main.py</code> with the desired model architecture and the path to the ImageNet dataset:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resnet18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [imagenet-folder </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> val</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> folders]</span></span></code></pre></div><p>The default learning rate schedule starts at 0.1 and decays by a factor of 10 every 30 epochs. This is appropriate for ResNet and models with batch normalization, but too high for AlexNet and VGG. Use 0.01 as the initial learning rate for AlexNet or VGG:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alexnet</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --lr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [imagenet-folder </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> val</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> folders]</span></span></code></pre></div><h2 id="use-dummy-data" tabindex="-1">Use Dummy Data <a class="header-anchor" href="#use-dummy-data" aria-label="Permalink to &quot;Use Dummy Data&quot;">​</a></h2><p>ImageNet dataset is large and time-consuming to download. To get started quickly, run <code>main.py</code> using dummy data by &quot;--dummy&quot;. It&#39;s also useful for training speed benchmark. Note that the loss or accuracy is useless in this case.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resnet18</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dummy</span></span></code></pre></div><h2 id="multi-processing-distributed-data-parallel-training" tabindex="-1">Multi-processing Distributed Data Parallel Training <a class="header-anchor" href="#multi-processing-distributed-data-parallel-training" aria-label="Permalink to &quot;Multi-processing Distributed Data Parallel Training&quot;">​</a></h2><p>You should always use the NCCL backend for multi-processing distributed training since it currently provides the best distributed training performance.</p><h3 id="single-node-multiple-gpus" tabindex="-1">Single node, multiple GPUs: <a class="header-anchor" href="#single-node-multiple-gpus" aria-label="Permalink to &quot;Single node, multiple GPUs:&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resnet50</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dist-url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tcp://127.0.0.1:FREEPORT&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dist-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;nccl&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --multiprocessing-distributed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --world-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rank</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [imagenet-folder </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> val</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> folders]</span></span></code></pre></div><h3 id="multiple-nodes" tabindex="-1">Multiple nodes: <a class="header-anchor" href="#multiple-nodes" aria-label="Permalink to &quot;Multiple nodes:&quot;">​</a></h3><p>Node 0:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resnet50</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dist-url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tcp://IP_OF_NODE0:FREEPORT&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dist-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;nccl&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --multiprocessing-distributed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --world-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rank</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [imagenet-folder </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> val</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> folders]</span></span></code></pre></div><p>Node 1:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resnet50</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dist-url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tcp://IP_OF_NODE0:FREEPORT&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dist-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;nccl&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --multiprocessing-distributed</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --world-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rank</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [imagenet-folder </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> val</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> folders]</span></span></code></pre></div><h2 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">usage:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.py</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [-h] [-a ARCH] [-j N] [--epochs N] [--start-epoch N] [-b N] [--lr LR] [--momentum M] [--wd W] [-p N] [--resume PATH] [-e] [--pretrained] [--world-size WORLD_SIZE] [--rank RANK]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [--dist-url DIST_URL] [--dist-backend DIST_BACKEND] [--seed SEED] [--gpu GPU] [--multiprocessing-distributed] [--dummy]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [DIR]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PyTorch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ImageNet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Training</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">positional</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arguments:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  DIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                   path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dataset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (default: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">imagenet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optional</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arguments:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -h,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            show</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ARCH,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ARCH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  model</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> architecture:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alexnet</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convnext_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convnext_large</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convnext_small</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convnext_tiny</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> densenet121</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> densenet161</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> densenet169</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> densenet201</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> efficientnet_b0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        efficientnet_b1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> efficientnet_b2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> efficientnet_b3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> efficientnet_b4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> efficientnet_b5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> efficientnet_b6</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> efficientnet_b7</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> googlenet</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inception_v3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mnasnet0_5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mnasnet0_75</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        mnasnet1_0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mnasnet1_3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mobilenet_v2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mobilenet_v3_large</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mobilenet_v3_small</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_x_16gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_x_1_6gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_x_32gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_x_3_2gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_x_400mf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_x_800mf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        regnet_x_8gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_y_128gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_y_16gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_y_1_6gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_y_32gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_y_3_2gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_y_400mf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_y_800mf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> regnet_y_8gf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resnet101</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resnet152</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resnet18</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        resnet34</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resnet50</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resnext101_32x8d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resnext50_32x4d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shufflenet_v2_x0_5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shufflenet_v2_x1_0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shufflenet_v2_x1_5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shufflenet_v2_x2_0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> squeezenet1_0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> squeezenet1_1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vgg11</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        vgg11_bn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vgg13</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vgg13_bn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vgg16</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vgg16_bn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vgg19</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vgg19_bn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vit_b_16</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vit_b_32</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vit_l_16</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vit_l_32</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> wide_resnet101_2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> wide_resnet50_2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (default: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">resnet18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --workers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     number</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> loading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> workers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (default: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --epochs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            number</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> total</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> epochs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --start-epoch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       manual</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> epoch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (useful </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restarts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch-size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  mini-batch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (default: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">256</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), this is the total batch size of all GPUs on the current node when using Data Parallel or Distributed Data Parallel</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --lr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LR,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --learning-rate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        initial</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> learning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --momentum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          momentum</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --wd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> W,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --weight-decay</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> W</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        weight</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> decay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (default: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1e-4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --print-freq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  print</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> frequency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (default: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --resume</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PATH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> latest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (default: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">none</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  -e,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --evaluate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        evaluate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> model</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> validation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --pretrained</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pre-trained</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> model</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --world-size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> WORLD_SIZE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        number</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nodes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> distributed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> training</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --rank</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RANK</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rank</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> distributed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> training</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --dist-url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DIST_URL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> used</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> distributed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> training</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --dist-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DIST_BACKEND</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        distributed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backend</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --seed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SEED</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           seed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initializing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> training.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --gpu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             GPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --multiprocessing-distributed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        Use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi-processing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> distributed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> training</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> launch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> processes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> per</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> which</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> has</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GPUs.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> This</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fastest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> way</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PyTorch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> either</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> single</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> parallel</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                        training</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  --dummy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fake</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> benchmark</span></span></code></pre></div>`,25)]))}const y=i(t,[["render",k]]);export{g as __pageData,y as default};
